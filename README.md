# グリッド割り当て問題の定式化

## 問題設定
- $n\times n$ の碁盤状グリッド。各セル $(i,j)$ にスコア $g_{ij}$ が割り当てられている。  
- $m$ 人のプレイヤーがそれぞれグリッド上に石を配置する。  
  1. 各セルには高々1つの石を置く。
  2. プレイヤー $k$ の得点は、彼が石を置いたセルの値の総和。  
  3. 各プレイヤー $k$ には最低得点要求 $R_k$が存在する。  
  4. グリッドは $A$ 領域に分割され、各領域には少なくとも1つ石を配置。  

---

## 変数
### 決定変数
$$
x_{ijk} =
\begin{cases}
1, & \text{プレイヤー \(k\) がセル \((i,j)\) に石を置く},\\
0, & \text{それ以外}.
\end{cases}
$$

### 補助変数
隣接するセルのペアの集合 $\mathcal{P}$ を考え、各ペア $p=((i_1,j_1),(i_2,j_2))$ に対し補助変数 $z_{pk}$ を定義する.  

---

## 制約条件
1. **各セルに高々1つの石**  
   $$
     \sum_{k=1}^m x_{ijk} \;\le\; 1
     \quad\forall\,i,j.
   $$
2. **各プレイヤーの最低得点要求**  
   $$
     \sum_{i=1}^n \sum_{j=1}^n g_{ij}\,x_{ijk} \;\ge\; R_k
     \quad\forall\,k.
   $$
3. **各領域 \(a\) に少なくとも1石**  
   $$
     \sum_{(i,j)\in \mathcal{A}_a}\sum_{k=1}^m x_{ijk} \;\ge\; 1
     \quad\forall\,a.
   $$
4. **補助変数が隣接するセルの石が異なるプレイヤーの場合1を,同じ場合0を取る**
    $$
    0\leq z_{pk}\leq1,\quad
    z_{pk} \;\ge\; x_{i_1j_1k} - x_{i_2j_2k}, 
    \quad
    z_{pk} \;\ge\; x_{i_2j_2k} - x_{i_1j_1k}
    $$
---

## 目的関数
隣接セルに置かれた石が異なるプレイヤーであるペア数を最小化。  
$$
\min\;\,\sum_{p\in\mathcal{P}}\sum_{k=1}^m z_{pk}
$$