# 環境構築
## uvによるpython環境の構築
以下のコマンドでuvをインストール。
```
curl -Ls https://astral.sh/uv/install.sh | bash
```
インストールを確認。
```
uv --version
```
## MIPソルバー(HiGHS)のインストール
https://github.com/JuliaBinaryWrappers/HiGHSstatic_jll.jl/releases
から自分の環境にあったHiGHSバイナリをダウンロードし任意のディレクトリに展開する。

実行ファイルの実行権限を付与して,展開したディレクトリ内のbinフォルダへのパスを~/.bashrcまたはターミナルで設定する。
```
chmod +x {highsを展開したディレクトリのパス}/bin/highs
export PATH="$PATH:/{highsを展開したディレクトリのパス}/bin"
```
パスが通っていることを確認。
```
highs --version
```

## 最適化の実行
uvコマンドから最適化を実行すると、ビジュアライズされた結果がoutputフォルダに生成される。
```
uv run main.py
```


# 連結性制約を考慮した整数計画問題

## 問題設定
- $n\times n$ の碁盤状グリッド。各セル $(i,j)$ にスコア $g_{ij}$ が割り当てられている。  
- $m$ 人のプレイヤーがそれぞれグリッド上に石を配置する。  
  1. 各セルには高々1つの石を置く。
  2. プレイヤー $k$ の得点は、彼が石を置いたセルの値の総和。  
  3. 各プレイヤー $k$ には最低得点要求 $R_k$が存在する。  
  4. グリッドは $A$ 領域に分割され、各領域には少なくとも1つ石を配置。
  5. 各プレイヤーの石が置かれた領域はなるべく連結していなければいけない。

---

## 変数
### 決定変数
$
x_{ijk} =
\begin{cases}
1, & \text{プレイヤー \(k\) がセル \((i,j)\) に石を置く},\\
0, & \text{それ以外}.
\end{cases}
$

---

## 制約条件
1. **各セルに高々1つの石**  
   $
     \sum_{k=1}^m x_{ijk} \;\le\; 1
     \quad\forall\,i,j.
   $
2. **各プレイヤーの最低得点要求**  
   $
     \sum_{i=1}^n \sum_{j=1}^n g_{ij}\,x_{ijk} \;\ge\; R_k
     \quad\forall\,k.
   $
3. **各領域 \(a\) に少なくとも1石**  
   $
     \sum_{(i,j)\in \mathcal{A}_a}\sum_{k=1}^m x_{ijk} \;\ge\; 1
     \quad\forall\,a.
   $
4. **各プレイヤーの石が置かれた領域はなるべく連結していなければいけない。**

    様々な定式化を検討する。

---

## 目的関数
    様々な定式化を検討する。

---

## 推奨戦略 (Recommended Strategy)
現実的な設定では、解の質と計算時間のバランスを取ることが重要です。以下のハイブリッド戦略（マテヒューリスティクス）を推奨します。

1.  **フェーズ1：高品質な初期解の生成**
    *   `edge_diff` の定式化を、短い時間制限（例：30〜90秒）で実行します。
    *   これにより、連結性が高く、非常に質の良い初期解を高速に得ることができます。

2.  **フェーズ2：局所探索による改善**
    *   フェーズ1で得られた解を初期値として、`heuristic` の局所探索アルゴリズムを実行します。
    *   これにより、初期解の細かな弱点を修正し、さらに解を改善することができます。

このアプローチは、MIPソルバー大域的な構造を捉える能力と、局所探索の高速な改善能力の両方を活用するため、実用的な時間内で高品質な解を得るための最良の選択肢となります。
